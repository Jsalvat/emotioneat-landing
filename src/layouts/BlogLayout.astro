---
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import en from '../i18n/en.json';

export interface Props {
	title: string;
	description: string;
	image?: string;
	canonical?: string;
	published_at?: string;
	updated_at?: string;
}

const { title, description, image = '/og-image.jpg', canonical } = Astro.props;
const t = en;

const canonicalUrl = canonical || new URL(Astro.url.pathname, Astro.site).href;
---

<!doctype html>
<html lang="en" class="scroll-smooth">
	<head>
		<meta charset="UTF-8" />
		<meta name="description" content={description} />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="icon" type="image/svg+xml" href="/favicon.png" />
		<meta name="generator" content={Astro.generator} />

		<!-- SEO -->
		<title>{title}</title>
		<meta name="description" content={description} />
		<link rel="canonical" href={canonicalUrl} />

		<!-- Open Graph / Facebook -->
		<meta property="og:type" content="article" />
		<meta property="og:url" content={Astro.url} />
		<meta property="og:title" content={title} />
		<meta property="og:description" content={description} />
		<meta property="og:image" content={new URL(image, Astro.site)} />

		<!-- Twitter -->
		<meta property="twitter:card" content="summary_large_image" />
		<meta property="twitter:url" content={Astro.url} />
		<meta property="twitter:title" content={title} />
		<meta property="twitter:description" content={description} />
		<meta property="twitter:image" content={new URL(image, Astro.site)} />

		<!-- Fonts -->
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet" />

		<!-- Schema.org for Blog Post -->
		<script type="application/ld+json" is:inline set:html={JSON.stringify({
			"@context": "https://schema.org",
			"@type": "BlogPosting",
			"headline": title,
			"description": description,
			"image": image ? [new URL(image, Astro.site).href] : [],
			"datePublished": Astro.props.published_at || new Date().toISOString(),
			"dateModified": Astro.props.updated_at || new Date().toISOString(),
			"author": {
				"@type": "Organization",
				"name": "EmotionEat Team"
			},
			"publisher": {
				"@type": "Organization",
				"name": "EmotionEat",
				"logo": {
					"@type": "ImageObject",
					"url": new URL('/favicon.png', Astro.site).href
				}
			}
		})} />

		<!-- GA4 -->
		{import.meta.env.PUBLIC_GA4_ID && (
			<>
				<script is:inline async src={`https://www.googletagmanager.com/gtag/js?id=${import.meta.env.PUBLIC_GA4_ID}`}></script>
				<script is:inline define:vars={{ GA4_ID: import.meta.env.PUBLIC_GA4_ID }}>
					window.dataLayer = window.dataLayer || [];
					function gtag(){dataLayer.push(arguments);}
					gtag('js', new Date());
					gtag('config', GA4_ID);
				</script>
			</>
		)}

		<!-- GSC Verification -->
		{import.meta.env.PUBLIC_GSC_VERIFICATION_CODE && (
			<meta name="google-site-verification" content={import.meta.env.PUBLIC_GSC_VERIFICATION_CODE} />
		)}
	</head>
	<body class="bg-neutral-50 text-neutral-900 font-sans pt-16">
		<Header t={t} />

		<main class="min-h-screen">
			<slot />
		</main>

		<Footer t={t} />
	</body>
</html>

<style is:global>
	html {
		font-family: 'Plus Jakarta Sans', system-ui, sans-serif;
		scroll-behavior: smooth;
	}

	body {
		margin: 0;
		padding: 0;
		min-height: 100vh;
		display: flex;
		flex-direction: column;
	}

	main {
		flex: 1;
	}

	/* Blog specific styles */
	.prose {
		max-width: none;
	}

	.prose h1 {
		font-size: 2.5rem;
		font-weight: 700;
		line-height: 1.2;
		margin-bottom: 2rem;
		color: #171717;
	}

	.prose h2 {
		font-size: 1.875rem;
		font-weight: 600;
		line-height: 1.3;
		margin-top: 3rem;
		margin-bottom: 1.5rem;
		color: #171717;
		border-bottom: 2px solid #e5e5e5;
		padding-bottom: 0.5rem;
	}

	.prose h3 {
		font-size: 1.5rem;
		font-weight: 600;
		line-height: 1.3;
		margin-top: 2.5rem;
		margin-bottom: 1rem;
		color: #262626;
	}

	.prose p {
		line-height: 1.7;
		margin-bottom: 1.5rem;
		color: #525252;
	}

	.prose ul, .prose ol {
		margin-bottom: 1.5rem;
		padding-left: 1.5rem;
	}

	.prose li {
		margin-bottom: 0.5rem;
		line-height: 1.6;
		color: #525252;
	}

	.prose strong {
		font-weight: 600;
		color: #171717;
	}

	.prose blockquote {
		border-left: 4px solid #E8847C;
		padding-left: 1rem;
		margin: 2rem 0;
		font-style: italic;
		color: #737373;
		background: #fafafa;
		padding: 1rem 1.5rem;
		border-radius: 0.375rem;
	}

	.prose img {
		border-radius: 0.5rem;
		margin: 2rem 0;
		box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
	}

	.prose a {
		color: #E8847C;
		text-decoration: underline;
		transition: color 0.2s;
	}

	.prose a:hover {
		color: #D4605A;
	}
</style>
